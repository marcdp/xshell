
<!-- styles -->
<style>
    :host {border:2px red solid; display:block;}
    ul {margin:0; padding:0; }
    li {display:inline}
    li + li:before {content: " / ";}
</style>

<!-- template -->
<template>
    <nav>
        <ul>
            <li x-for="item in state.breadcrumb">
                <a x-attr:href="item.href">{{ item.label }}</a>
            </li>
            <li>
                {{ state.label }}
            </li>
        </ul>
    </nav>    
</template>

<!-- script -->
<script type="module">
    import xshell from "../../../x-shell.js";
    export default {
        state: {
            breadcrumb: [],
            label: ""
        },
        onCommand(command) {
            if (command == "load") {
                //load
                let page = xshell.getPage(this);  
                if (page) {
                    page.addEventListener("page:load", () => {
                        this.onCommand("refresh");
                    });
                    page.addEventListener("page:change", () => {
                        this.onCommand("refresh");
                    });
                }
                this.onCommand("refresh");

            } else if (command == "refresh") {
                //refresh
                let page = xshell.getPage(this);
                if (page) {
                    let breadcrumb = [];
                    for (let item of page.breadcrumb) {
                        let label = item.label;
                        let href = xshell.getRealUrl(item.href);
                        breadcrumb.push({label, href});
                    }
                    this.state.breadcrumb = breadcrumb;
                    this.state.label = page.label;
                }
            }
        }
    }
</script>
