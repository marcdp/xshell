<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport"    content="width=device-width, initial-scale=1.0">
    <meta name="description" content="XShell is a microfrontend shell to build modular web applications.">
    <!-- config meta tags for xshell -->
    <meta name="xshell.app_config_url"  content="/apps/app1/app.jsonc">
    <meta name="xshell.sw_url"          content="/apps/app1/sw.js">
    <!-- bootstrap -->
    <script src="/xshell/bootstrap.js"></script>
</head>
<body>
</body>
</html>


<!--
x - error
x - go back -- should close any opened dialog at end
x - stack -- backdrop
x - stack -- title + close
x- dialog -- title + close
x - breadcrumb
x - load pages from path like /x/pages/....
x - path -- move to src
x- app.getRealUrl -- page.getHref("page1.html", settings)
x- mpashell -- xshell
x - loader.page-handler:... -- remove
x - loader.class:converter-page-handler-html...
x - loader.class:converter-page-handler-x... 
x - pensar manera que es puguin carregar diferents handlers de cada modul
x - handler -- factory? 
x - store instance of instance at x-page level
x - handler sfc
x - pensar sistema de tenir multiples handlers (i que cada modul pugi especificar el handle a utilitzar (html, sfc, etc))
x - menus pensar manera de tenir N menus, i que cada modul posi les seves coses al menu general o be al seu propi menu
x - no fer this.page.addEventListener ...
x - load page that has error : we must show the errors to the user
x - page -> poder afegir l'estat en una capsalera meta
x - menu esquerra
x - show all errors when loading page3
x - select menuitem in x-drawer-menu
x - layouts -- prefix with x-layout-...
x - x-layout-main -- show logo
x - x-layout-* ... pensar si cal utilitzar el shadowDOM
x - x-drawer-menu -- main title/label
x - set default label based on title of the menuitem
x - estils basics layouts (main, stack, embed, dialog, default)
x - aws console styles
x - mobile: click on menuitem should close the menu
x - page.load(): breadcrumb: get module from breadcrumb first url
x - podria ser una pagina d'un modul visualitzada desde el menú d'un modul original (cal mostrar el menu del modul original)
x - link with ?breadcrumb=xxxxxx   should work, and show the breadcrumb
x - stack animation
x - menuitem -- allow embed page
x - responsive
x - components
x - x-search
x - x-layout-main -- page max width + centered
x - x-lazy
x - x-shell-search  -- > opens a x-search-page
x - embed page
x - x-dropdown -- 
x - do not use commands like state-changed
x - on module load: send an event to the bus like 'module-loaded' with the module name
x - bus: use window.... methods to throw events -- Not at the moment
x - browse modules: each module should have a default page
x - the modules.html page should list all loaded modules with a link to the start page of each module
x - the modules.html should be showed in a dropdown manner at the top of the page (or as stack page at left)
x - each module should have a list of main menuitems
x - allow config "shell.debug"
x - each module should have an logo
x - x-loading -- cicle
x - loader: should be able to load resources from a url (ex: icon:https://......icon.svg, icon:./icon.svg, icon:icon.svg, ...icon: /x/icons/my-icon.svg)
x - x-listview
x - x-listview big icons
x - modules: show grid of icons with the logo of each module
x- x-dropdown auto closess!!! why??? -- review utils.isDescendantOfContainer -- it is not working properly, should enter in all shadowRoots
x - modules.module1.type = "application" | "theme" | "..."
x - show page at bottom right corner + icon to minimize or expand, call it "#tray"
x - x-popover -- foucs out -- hide
x - page: activate/deactivate on dropdown pages
x - page: activate/deactivate ?? val la pena??? NO
x - module: activate/deactivate ??? NO
x - wizard styles like: https://eu-west-1.console.aws.amazon.com/console/applications/create-application?nc2=h_ct&region=eu-west-1&src=header-signin
x - tabs -- increment font size
x - top right icon should expand a page floating at the left direction
x - x-form + x-datafields + x-pager + x-richtext + x-code-editor
x - button disabled
x- details (title + body expandable)
x - x-datafield focus
x- fieldset 
x - x-datafield with langs
x - menu drop down
x - menu drop down de segon nivell
x - create module with documentation pages: for x-buttons, for x-icons, x-cards, pages , etc layouts
x- in debug mode, we should show the "/x/pages/debug" as dropdown ???? This page should have:
x - loader: allow define nont cacheable???
x - sfc: use <template> tag in the definition of a page
x - loader -- page:/x/pages/debug.html
x - sfc style -- global
x - mobile drawer menu -- should scroll vertically
x - observedAttributes: fer que no sigui obligatori especificarlos. Per defecte, tots els state.props de tipus simple (bool, int, float, string, date) poden venir dels attributs
x - permetre cachejar les pages: --. implicar no utilitzar transform:"response" en el fetch del loader
x - menuitems separador + expandable
x - refs -- NO
x - x-dropdown remove double click
x - x-button - remove document click
x - favicon
x - dropdown page padding
x - nested embedde pages padding
x - x-template -- remove shortcuts for setting attributes, properties and events --- NO
x - showWorking
x - refs
x - x-json
x - loader: should throw exception if error
x - shell.loadModule -- use reject if error loading
x - x-search
x - search: show modules of the search results
x - x-desktop
x - x-mobile
x - search page: module listens for "search" command, and returns an async task with the results NO
x - show page md -- show in light dom
x - x-markdown -- auto load components
x - playground page -- fill all space!!!
x - search page: load all modules and perform an async "search" command in all of them NO
x - x-playground - auto refresh
x - x-html with colors
x - show error loading unexisting web component
x - x-datetime
x - page.js -- page.srcAbsolute
x - import {bus} from "./../../shell.js";
x - load page of unexisting module should show an error message
x - error.html ? add "page" argument, add "module" argument
x - load page of unexisting module should hide the breadcrumb, and left menu
x - remove all uses of navigation-end.module
x - remove all uses of page.module use the page.src or page.srcPage to obtain the module
x - set loader config from outside
x - loader-handler: fetch, import, ..
x - eliminar loader.transforms -- fer ho tot amb els loader-handlers (ex: loader-handler=svg)
x - loader-handler page-markdown -- ha de crear un html, amb <x-markdown src="..."></x-markdown>
x - loader-handler page-pdf
x - page.replace(src)
x - tabs hash
x - page.hash hierarchycal NO
x - if menu has single page, then we should hide the menu??? NO
x - each module can show custom menu tools -- use @scope to style right menu items
x - when stack is showed, add  overflow:hidden to body
x - /x/pages/debug-modules.html -- modules loaded -- listview with columns: status, path, description, icon, etc
x - /x/pages/debug-modules.html: auto refresh, when module loaded
x - /x/pages/debug-config.html -- config -- show config as table key value
x - shell.dispatchEvent("navigation-start")
x - shell.dispatchEvent("navigation-end")
x - shell.dispatchEvent("search", {})
x - /x/pages/debug-loader.html -- pages loaded -- show listsview
x - x-treeview -- use counter to mark even/odd rows
x - /x/pages/debug-pages.html -- pages loaded -- show listsview
x - x-treeview - with of columns
x - x-treeview - pensar algun databind recursiu
x - x-treeview: pensar databind per les columnes
x - pages: error pages: status= error
x - pages: load time
x - modules: load time
x - remove shell started-at
x - pages: size
x - debug-pages -- show stats.size
x - shell: load time
x - loader.load("", stats)
x - /x/pages/debug-pages --- show load errors in red
x - /x/pages/debug-pages --- show odd/even rows in different colors
x - x-file-size -- to format file sizes
x - x-time-ms -- to format time in ms
x - /x/pages/debug-loader --- show load errors in red
x - x-recursive -- node container ??
x - x-attr:class="{xxx:xx, b:bbbb}" -- should add class xxxxxxxx if value true
x - x-class:xxxxxxxx="state.enabled" -- should add class xxxxxxxx if value true
x - x-menu selected
x - x-menu with ul
x - menu -- render recursive
x - do not use config["modules.x.status"] = "loaded" !!!! config should be readonly !!! is not state!!!!
x - treeview
x - top menu (like for example in aws console, wher all modules are showed)
x - service worker actiu sempre
x - modules should not modify "loaders.icon.." -> bootstrap should do it
x - loader -> resolver
x - modules -> import map
x - if development -> service worker should not cache anything. Only transform
x - fer que cada modul declari els seu "importmap", y que el bootstrap.js crei el importmap global amb tots els imports de tots els moduls (ex: "xhell", "x-shell/", ...)
x - page-instance -> page.js
x - handlers
x - handler-icon.js
x - handler-import.js
x - handler-md.js
x - handler-html.js
x - module.js -> files with onCommand
x - poder enviar arguments al module onCommand("load", { ... })
x - crear xshell.events
x - page controller X (sfc pages)
x - x pages -- > use XController !!
x - page not found
x - error page 
x - debug drop down bigger
x - fer que el application selector funcioni
x - fer que tot funcioni (popups, dialogs, stacks, embeds, etc) 
x - fer que ace-editor funcioni
x - page error recursive
x - error al obrir la mateixa pagaina dos cops en stack
x - xshell-page-breadcrumb
x - navigation.js
x - avoid reload /xshell/page-current.js
x - xshell: remove addEventListener, ...
x - menu: select item excluding hash
x - bus event viewer
x - bus event autoscroll
x - bus event clear
x - bus -> use MessageChannel
x - Crar modul de debug x-debug
x - identity provider
x - identity provider: idp:anonymous
x - show identity in default layout
x - dialog -> passar el state a la pagina del dialog
x - x-page -> pasarli d'alguna manera el state (por property)
x - implement navigation.js
x - xshell.tabs
x - xshell.menu -- > composite menus (everybodu should use this service to create menus)
x - modules -> menuas defined in modules participates to main menus
x - bus asincrono
x - menus -> sources
x - Debug bus: debug.emit("log:info:..., eventa fins que la sessio de debug llegira
x- rewrite normal anchor urls?
x - rewrite x- anchor urls?
x - allow to load js pages
x - allow to load raw html pages (no sfc)
x - move old html pages to js pages
x - md pages frontmattern
x - <x-anchor breadcrum ...
x - <x-anchor disabled> ...
x - simplify x-anchor -> only urls relative to app base root ! no commands, no external urls, no hash navigation
x - menus -> do not rebuild on each page navigation (compute all areas+menus once, and refrsh only the dinamic sources on each page navigation)
x - create component-js.js to load webcomponents from js files
x - rewrite urls inside web components
x - <x-anchor open="dialog" ...
x - <x-anchor open="stack" ...
x - x-page-breacrumb component
x - x-page-title component
x- - remove breadcrumb render login from x-layout-main, and use only the web component created
x - <x-anchor replace>... replace history
x - x-button, only commands, no href
x - error component
x - loading animation in pages
x - no- x-page-url -- to show the url of the page in the breadcrumb
x - identity
x - identity.js
x - utilizar una única variable "nav=" donde meter title+icon+breadcrumb+stack
x - x-page-description
x - page state: qs: true

- page state: qs: true, reflect:true

- pagina de ayuda de modulos
- pagina de ayuda de html normal
- pagina de ayuda de anchors
- pagina de ayuda de dialogs

- convertir all pages to new format
- search page (search in areas + modules + pages)
- no enviar las request al servidor con los parametros "nav.*"
- convertir web components a declarative web components!!
- dialog.picker() -- > open a dialog with a picker page, and return the result
- eliminar x/controllers



- page -> when consuming services as log -> return a instance of log per that page exactly (that generates  prefixed log entries)

- python dev server: enforce CSP strict compliance

- objective: CSP strict compliance. Currently the 2 obstacles to an strict CSP compliant mode are:
    - x-template.js -> uses "Func" -> we can migrate to use an IR object model and interpre it, nor evaluate it!!
        - allow only basic expression (property access and basic operations) (no method calls)
    - to import single_file_componenet pages (ex: /pages/page1.html) we can not have a inline script because it breaks CSP. Solution
        - make the default file /pages/page1.js. -- > defines the page controller and optionally imports the template from /pages/page1.html

    Solutions:
       - accept CSP lax mode

- menus:
    x - Group -- areaApp.json: deginir arees de navegacio (label i icon)
    x - Icono top left: mostrar arees de navegacio disponibles
    x - eliminar "start" dels modulos, y pasar a tenir "home" per area
    x - pensar deeplinks
    x - Pagina inicial por cada area
    x - menu profile
    - autotranslate relative url in templates and stylesheets in XElement.define !!! call to a central resolucion function lie xshell.modules.translateUrls(template, moduleName)
    

    - compute area prefixes
    - Check permisos al crear el menúitems
    - Breadcrumb: mostrar prefijo de la area
    - Ctrl+k: search shortcut
    - Si user navigates to a protected page: show nav bloked message
    - Mostrar el icono del area
    - Search only in current area, but with a buton to search in all aread
- si debug=true -- > mostrar botó que obri una nova pestanya de debug

- mostrar tots els moduls amb menú MAIN en el desplegable superior esquerra si o si

- xshell.storage
- xshell.settings -> storage

- crear prefix per a descarregar moduls "/apps/app/assets/..." o "/apps/app/cdn/..."

- path navigation

- El xshell ha de tenirbun canal de control(addeventlistener de missatges del sw)

- sw: avoid pass url of real service worker in query string- > security error!!

- module x-idp-basic -> ask for login and password

- x-debugger module


- record resources load time + size
- show resources load time + size in debug pages + modules
- hash navigation + path navigation flag (xshell.navigation.mode = "hash" | "path") 
- zip packages modules
- deep links ?

- menus: badges + icons
- menus: evaluate ACL (when ....)


FASE 2
- xshell.api
- xshell.permissions
- xshell.fs
- xshell.jobs


- x-listview -- create x-listview-body, x-listview-head, x-listview-column, x-listview-row
- x-listview -- use :part to style elements
- x-listview -- selected 
- x-listview -- arrows selection
- /x/pages/debug-modules --- use x-treeview
- /x/pages/debug-loader --- use x-treeview
- /x/pages/debug-pages: click -- navigate to page
- /x/pages/debug-pages: click in an icon -- open source file in new tab
- /x/pages/debug-components.html --- show list of web components (size, load time, etc, source file)
- docs
- x-splitter
- use Auth0 + OpenID Connect (OIDC)
  - navigation
  - auto load modules and web components
  - authentication
  - user menu
- datafield file 
- datafield files
- datafield image
- datafield images
- input select un registre d'una taula sortable i varies columnes (ex: https://eu-west-3.console.aws.amazon.com/dynamodbv2/home?region=eu-west-3#dax-cluster-create) d'un datatable?
- npm package
- module data ??? think about that
- i18n: pensar sistema de que cada modul tingui les seves propies traduccions i utilitzi la seva propia taula de traduccions


-->